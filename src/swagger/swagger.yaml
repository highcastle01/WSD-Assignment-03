openapi: 3.0.0
info:
  title: 웹서비스설계 과제3
  version: 1.0.0
  description: 202012237 임성혁의 swagger 문서입니다.
servers:
  - url: http://113.198.66.75:18225
    description: 개발 서버

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    User:
      type: object
      properties:
        id:
          type: integer
        email:
          type: string
          format: email
        name:
          type: string
        phone:
          type: string
        career:
          type: integer
        skillSet:
          type: array
          items:
            type: string
        lastLoginAt:
          type: string
          format: date-time

    Company:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        industry:
          type: string
        size:
          type: string
        location:
          type: string
        employeeCount:
          type: integer
        foundedYear:
          type: integer
        companyUrl:
          type: string

    Job:
      type: object
      properties:
        id:
          type: integer
        companyId:
          type: integer
        title:
          type: string
        description:
          type: string
        requiredSkills:
          type: array
          items:
            type: string
        requiredCareer:
          type: integer
        salary:
          type: object
          properties:
            min:
              type: integer
            max:
              type: integer
        location:
          type: string
        jobType:
          type: string
          enum: [FULL_TIME, PART_TIME, CONTRACT, INTERNSHIP]
        deadline:
          type: string
          format: date-time
        education:
          type: string
        position:
          type: string
        viewCount:
          type: integer

    Application:
      type: object
      properties:
        id:
          type: integer
        userId:
          type: integer
        jobId:
          type: integer
        status:
          type: string
          enum: [지원완료, 서류검토중, 서류합격, 최종합격, 불합격]
        coverLetter:
          type: string
        appliedAt:
          type: string
          format: date-time

    Bookmark:
      type: object
      properties:
        id:
          type: integer
        userId:
          type: integer
        targetType:
          type: string
          enum: [job, company]
        targetId:
          type: integer

    SearchHistory:
      type: object
      properties:
        id:
          type: integer
        userId:
          type: integer
        keyword:
          type: string
        filters:
          type: object
        searchedAt:
          type: string
          format: date-time

    CompanyReview:
      type: object
      properties:
        id:
          type: integer
        userId:
          type: integer
        companyId:
          type: integer
        title:
          type: string
        content:
          type: string
        pros:
          type: string
        cons:
          type: string
        rating:
          type: integer
          minimum: 1
          maximum: 5
        workPeriod:
          type: string
        position:
          type: string
        isCurrentEmployee:
          type: boolean
    InterviewReview:
        type: object
        properties:
          id:
            type: integer
            example: 1
          userId:
            type: integer
            example: 10
          companyId:
            type: integer
            example: 5
          companyName:
            type: string
            example: "Sample Company"
          result:
            type: string
            enum: ["합격", "불합격", "대기중"]
            example: "합격"
          process:
            type: string
            example: "면접 과정은 3단계로 이루어졌습니다."
          questions:
            type: string
            example: "자신의 장점과 단점을 말해보세요."
          note:
            type: string
            example: "면접 분위기는 편안했습니다."
          createdAt:
            type: string
            format: date-time
            example: "2024-12-15T10:58:32.000Z"
          updatedAt:
            type: string
            format: date-time
            example: "2024-12-16T09:51:00.000Z"

paths:
  /auth/register:
    post:
      tags:
        - Auth
      summary: 회원가입
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/User'
      responses:
        '201':
          description: 회원가입 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  user:
                    $ref: '#/components/schemas/User'

  /auth/login:
    post:
      tags:
        - Auth
      summary: 로그인
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
      responses:
        '200':
          description: 로그인 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  accessToken:
                    type: string
                  refreshToken:
                    type: string
                  user:
                    $ref: '#/components/schemas/User'
  /auth/refresh:
    post:
      tags:
        - Auth
      summary: Refresh 토큰을 이용한 새 액세스 토큰 발급
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - refreshToken
              properties:
                refreshToken:
                  type: string
      responses:
        '200':
          description: 액세스 토큰 발급 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  accessToken:
                    type: string
                    description: 새로 발급된 액세스 토큰
                  refreshToken:
                    type: string
                    description: 새로 발급된 리프레시 토큰

  /auth/profile:
    put:
      tags:
        - Auth
      summary: 사용자 프로필 업데이트
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - name
                - phone
                - career
                - skillSet
              properties:
                name:
                  type: string
                  description: 사용자 이름
                phone:
                  type: string
                  description: 사용자 전화번호
                career:
                  type: integer
                  description: 경력 (연수)
                skillSet:
                  type: array
                  items:
                    type: string
                  description: 보유 기술 스택
      responses:
        '200':
          description: 프로필 업데이트 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "프로필이 업데이트되었습니다."
                  user:
                    type: object
                    properties:
                      id:
                        type: integer
                      email:
                        type: string
                        format: email
                      name:
                        type: string
                      phone:
                        type: string
                      career:
                        type: integer
                      skillSet:
                        type: array
                        items:
                          type: string

  /jobs:
    get:
      tags:
        - Jobs
      summary: 채용 공고 목록 조회
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            default: 1
        - in: query
          name: limit
          schema:
            type: integer
            default: 20
        - in: query
          name: location
          schema:
            type: string
        - in: query
          name: career
          schema:
            type: integer
        - in: query
          name: skills
          schema:
            type: array
            items:
              type: string
        - in: query
          name: keyword
          schema:
            type: string
      responses:
        '200':
          description: 채용 공고 목록
          content:
            application/json:
              schema:
                type: object
                properties:
                  jobs:
                    type: array
                    items:
                      $ref: '#/components/schemas/Job'
                  total:
                    type: integer
                  currentPage:
                    type: integer
                  totalPages:
                    type: integer

    post:
      tags:
        - Jobs
      summary: 채용 공고 등록
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Job'
      responses:
        '201':
          description: 채용 공고 등록 성공
  /jobs/{id}:
  get:
    tags:
      - Jobs
    summary: 특정 채용 공고 조회
    parameters:
      - in: path
        name: id
        required: true
        schema:
          type: integer
        description: 조회할 채용 공고의 ID
    responses:
      '200':
        description: 채용 공고 상세 조회 성공
        content:
          application/json:
            schema:
              type: object
              properties:
                job:
                  type: object
                  $ref: '#/components/schemas/Job'
                isBookmarked:
                  type: boolean
                  description: 사용자가 해당 공고를 북마크했는지 여부
                relatedJobs:
                  type: array
                  description: 연관된 채용 공고 목록
                  items:
                    $ref: '#/components/schemas/Job'
      '404':
        description: 채용 공고를 찾을 수 없음
        content:
          application/json:
            schema:
              type: object
              properties:
                message:
                  type: string
                  example: "채용 공고를 찾을 수 없습니다."

    delete:
      tags:
        - Jobs
      summary: 특정 채용 공고 삭제
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: 삭제할 채용 공고의 ID
      responses:
        '200':
          description: 채용 공고 삭제 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "채용 공고가 삭제되었습니다."
                  jobId:
                    type: integer
        '404':
          description: 채용 공고를 찾을 수 없음
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "채용 공고를 찾을 수 없습니다."

  /applications:
    post:
      tags:
        - Applications
      summary: 채용 공고 지원
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - jobId
              properties:
                jobId:
                  type: integer
                coverLetter:
                  type: string
      responses:
        '201':
          description: 지원 성공
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Application'

    get:
      tags:
        - Applications
      summary: 내 지원 내역 조회
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: status
          schema:
            type: string
            enum: [지원완료, 서류검토중, 서류합격, 최종합격, 불합격]
      responses:
        '200':
          description: 지원 내역 목록
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Application'
  /applications/{id}:
    delete:
      tags:
        - Applications
      summary: 특정 지원 취소
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: 취소할 지원의 ID
      responses:
        '200':
          description: 지원 취소 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "알 수 없음의 5번 지원이 취소되었습니다."
                  companyName:
                    type: string
                  applicationId:
                    type: integer
        '500':
          description: 지원 취소 중 오류 발생
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "지원 취소 중 오류가 발생했습니다."

    put:
      tags:
        - Applications
      summary: 지원서 수정
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: 수정할 지원서의 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - coverLetter
              properties:
                coverLetter:
                  type: string
                  maxLength: 5000
      responses:
        '200':
          description: 지원서 수정 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "지원서가 성공적으로 수정되었습니다."
                  application:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 4
                      jobTitle:
                        type: string
                        example: "[기본급 250만+/인센+] 온라인마케팅/영업부 입사 지원금+100만"
                      company:
                        type: string
                        example: "알 수 없음"
                      coverLetter:
                        type: string
                        example: "수정된 자기소개서 내용입니다. 이 내용은 5000자를 넘지 않아야 합니다."
                      updatedAt:
                        type: string
                        format: date-time
                        example: "2024-12-15T10:58:32.000Z"
        '500':
          description: 지원서 수정 중 오류 발생
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "지원서 수정 중 오류가 발생했습니다."

  /bookmarks:
    post:
      tags:
        - Bookmarks
      summary: 북마크 토글
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - targetType
                - targetId
              properties:
                targetType:
                  type: string
                  enum: [job, company]
                targetId:
                  type: integer
      responses:
        '200':
          description: 북마크 토글 성공

    get:
      tags:
        - Bookmarks
      summary: 북마크 목록 조회
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 북마크 목록
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Bookmark'

  /search-history:
    post:
      tags:
        - Search History
      summary: 검색 기록 저장
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SearchHistory'
      responses:
        '201':
          description: 검색 기록 저장 성공

    get:
      tags:
        - Search History
      summary: 검색 기록 조회
      security:
        - bearerAuth: []
      responses:
        '200':
          description: 검색 기록 목록
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/SearchHistory'

    /search-history/{id}:
    delete:
      tags:
        - Search History
      summary: 특정 검색 기록 삭제
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: 삭제할 검색 기록의 ID
      responses:
        '200':
          description: 특정 검색 기록 삭제 성공
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "검색 기록이 삭제되었습니다."
        '404':
          description: 검색 기록을 찾을 수 없음
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "검색 기록을 찾을 수 없습니다."
        '500':
          description: 서버 오류
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "검색 기록 삭제 중 오류가 발생했습니다."
  /interview-reviews:
    get:
      tags:
        - InterviewReviews
      summary: 전체 면접 후기 조회
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            default: 1
          description: 페이지 번호
        - in: query
          name: limit
          schema:
            type: integer
            default: 10
          description: 한 페이지의 결과 개수
        - in: query
          name: companyId
          schema:
            type: integer
          description: 특정 회사 ID 필터링
        - in: query
          name: position
          schema:
            type: string
          description: 특정 직무 필터링
        - in: query
          name: difficulty
          schema:
            type: integer
          description: 난이도 필터링 (1-5)
        - in: query
          name: result
          schema:
            type: string
            enum: [합격, 불합격, 대기중]
          description: 결과 필터링
      responses:
        '200':
          description: 전체 면접 후기를 조회합니다.
          content:
            application/json:
              schema:
                type: object
                properties:
                  reviews:
                    type: array
                    items:
                      $ref: '#/components/schemas/InterviewReview'
                  total:
                    type: integer
                  currentPage:
                    type: integer
                  totalPages:
                    type: integer
        '401':
          description: 인증 오류

    post:
      tags:
        - InterviewReviews
      summary: 면접 후기 등록
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - companyId
                - companyName
                - difficulty
                - result
                - process
              properties:
                companyId:
                  type: integer
                  description: 회사 ID
                companyName:
                  type: string
                  description: 회사 이름
                difficulty:
                  type: integer
                  description: 면접 난이도 (1-5)
                result:
                  type: string
                  enum: [합격, 불합격, 대기중]
                  description: 면접 결과
                position:
                  type: string
                  description: 지원한 직무
                date:
                  type: string
                  format: date
                  description: 면접 날짜
                process:
                  type: string
                  description: 면접 프로세스 설명
                questions:
                  type: string
                  description: 질문 내용
                content:
                  type: string
                  description: 면접 후기 본문
                tips:
                  type: string
                  description: 면접 팁
      responses:
        '201':
          description: 면접 후기가 등록되었습니다.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "면접 후기가 등록되었습니다."
                  review:
                    $ref: '#/components/schemas/InterviewReview'
        '400':
          description: 요청 데이터가 잘못되었습니다.
        '401':
          description: 인증 오류

  /interview-reviews/{id}:
    put:
      tags:
        - InterviewReviews
      summary: 면접 후기 수정
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: integer
          description: 수정할 면접 후기 ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                difficulty:
                  type: integer
                  description: 면접 난이도 (1-5)
                result:
                  type: string
                  enum: [합격, 불합격, 대기중]
                  description: 면접 결과
                position:
                  type: string
                  description: 지원한 직무
                process:
                  type: string
                  description: 면접 프로세스 설명
                questions:
                  type: string
                  description: 질문 내용
                content:
                  type: string
                  description: 면접 후기 본문
                tips:
                  type: string
                  description: 면접 팁
      responses:
        '200':
          description: 면접 후기가 수정되었습니다.
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "면접 후기가 수정되었습니다."
                  review:
                    $ref: '#/components/schemas/InterviewReview'
        '404':
          description: 해당 면접 후기를 찾을 수 없습니다.
        '401':
          description: 인증 오류
